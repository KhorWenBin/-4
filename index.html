<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>åƒåœ¾åˆ†ç±»å¤§æŒ‘æˆ˜ (é«˜é¢œå€¼ç‰ˆ)</title>
    <style>
        /* --- 1. å…¨å±€ç¾åŒ– --- */
        :root {
            --bg-color: #fdfbf7;
            --text-color: #4a4a4a;
            --card-bg: #ffffff;
            --wet-color: #8d6e63;
            --dry-color: #34495e;
            --recycle-color: #4facfe;
            --harmful-color: #ff6b6b;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: "PingFang SC", "Rounded Mplus 1c", "Microsoft YaHei", sans-serif;
            background-color: var(--bg-color);
            /* å¯çˆ±çš„æ³¢ç‚¹èƒŒæ™¯ (çº¯CSSç»˜åˆ¶) */
            background-image: radial-gradient(#e0e0e0 2px, transparent 2px);
            background-size: 24px 24px;
            display: flex;
            flex-direction: column;
            align-items: center;
            height: 100vh;
            overflow: hidden;
            touch-action: none;
            color: var(--text-color);
        }

        /* --- 2. é¡¶éƒ¨èƒ¶å›Šä»ªè¡¨ç›˜ --- */
        header {
            width: 90%;
            max-width: 600px;
            margin-top: 20px;
            padding: 15px 25px;
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(10px); /* ç£¨ç ‚ç»ç’ƒç‰¹æ•ˆ */
            border-radius: 50px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.08);
            display: flex;
            justify-content: space-between;
            font-size: 1.1rem;
            font-weight: 800;
            z-index: 10;
            border: 2px solid #fff;
        }

        .score-badge { color: #f1c40f; text-shadow: 1px 1px 0 #e67e22; }
        .count-badge { color: #bdc3c7; }

        /* --- 3. æ¸¸æˆä¸»èˆå° --- */
        #game-area {
            flex: 1;
            width: 100%;
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* å¡ç‰‡è®¾è®¡ */
        #trash-item {
            width: 130px;
            height: 130px;
            background: var(--card-bg);
            border-radius: 25px;
            /* åŒå±‚é˜´å½±è¥é€ æ‚¬æµ®æ„Ÿ */
            box-shadow: 
                0 10px 20px rgba(0,0,0,0.1),
                0 2px 5px rgba(0,0,0,0.05),
                inset 0 0 0 4px #fff;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: grab;
            position: absolute;
            z-index: 100;
            transition: transform 0.2s cubic-bezier(0.34, 1.56, 0.64, 1); /* å¼¹æ€§åŠ¨ç”» */
            user-select: none;
        }

        #trash-item.dragging {
            transform: scale(1.15) rotate(8deg);
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
            cursor: grabbing;
            z-index: 1000;
        }

        #trash-item .emoji { font-size: 60px; margin-bottom: 5px; filter: drop-shadow(0 4px 2px rgba(0,0,0,0.1)); }
        #trash-item .name { font-size: 16px; font-weight: bold; color: #666; background: #f0f2f5; padding: 4px 12px; border-radius: 12px; }

        /* --- 4. åƒåœ¾æ¡¶è®¾è®¡ --- */
        #bins-container {
            width: 100%;
            height: 220px;
            display: flex;
            justify-content: space-evenly;
            align-items: flex-end;
            padding-bottom: 15px;
            background: linear-gradient(to top, rgba(255,255,255,1) 0%, rgba(255,255,255,0) 100%);
        }

        .bin {
            width: 22%;
            height: 160px; /* é»˜è®¤é«˜åº¦ */
            border-radius: 15px 15px 8px 8px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            font-weight: bold;
            position: relative;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 8px 15px rgba(0,0,0,0.2);
            padding-top: 10px;
        }

        /* æ¡¶ç›–è£…é¥° */
        .bin::before {
            content: '';
            position: absolute;
            top: -10px;
            width: 105%;
            height: 12px;
            border-radius: 10px;
            background: inherit;
            filter: brightness(1.1); /* æ¯”æ¡¶èº«äº®ä¸€ç‚¹ */
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .bin-wet { background: var(--wet-color); border-bottom: 6px solid #6d4c41; }
        .bin-dry { background: var(--dry-color); border-bottom: 6px solid #2c3e50; }
        .bin-recycle { background: var(--recycle-color); border-bottom: 6px solid #2980b9; }
        .bin-harmful { background: var(--harmful-color); border-bottom: 6px solid #c0392b; }

        /* æ‚¬åœæ—¶çš„äº¤äº’åé¦ˆ */
        .bin.hovered {
            height: 180px; /* å˜é«˜ */
            transform: translateY(-10px);
            filter: brightness(1.1);
        }
        
        .bin span { font-size: 36px; margin-bottom: 5px; z-index: 2; filter: drop-shadow(0 2px 0 rgba(0,0,0,0.2));}
        .bin div { font-size: 13px; text-align: center; line-height: 1.3; opacity: 0.95; z-index: 2; }

        /* --- 5. åé¦ˆ & æƒ©ç½šå¼¹çª— --- */
        
        /* æ­£ç¡®æ—¶çš„å½©å¸¦å®¹å™¨ */
        #confetti-container {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none;
            z-index: 998;
            overflow: hidden;
        }
        .confetti {
            position: absolute;
            width: 10px; height: 10px;
            background: #f00;
            animation: fall linear forwards;
        }
        @keyframes fall { to { transform: translateY(100vh) rotate(720deg); opacity: 0; } }

        /* æ­£ç¡®æ–‡å­—æç¤º */
        #feedback {
            position: absolute;
            top: 20%;
            font-size: 3rem;
            font-weight: 900;
            opacity: 0;
            pointer-events: none;
            z-index: 999;
            color: #2ecc71;
            text-shadow: 0 4px 10px rgba(46, 204, 113, 0.3);
            transition: all 0.4s;
            background: rgba(255,255,255,0.9);
            padding: 10px 30px;
            border-radius: 50px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        /* é”™è¯¯æƒ©ç½šçº¢å± */
        #error-modal {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(231, 76, 60, 0.9);
            backdrop-filter: blur(8px); /* é«˜çº§æ¨¡ç³Š */
            z-index: 2000;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            animation: popIn 0.3s;
        }
        @keyframes popIn { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }

        #error-modal h2 { font-size: 2.5rem; margin: 0; text-shadow: 0 2px 5px rgba(0,0,0,0.2); }
        .error-card {
            background: white;
            color: #333;
            padding: 20px 40px;
            border-radius: 20px;
            margin: 30px 0;
            text-align: center;
            box-shadow: 0 15px 30px rgba(0,0,0,0.2);
        }
        .correct-tag {
            display: inline-block;
            background: #2ecc71;
            color: white;
            padding: 5px 15px;
            border-radius: 10px;
            margin-top: 10px;
            font-weight: bold;
        }
        .timer-ring {
            width: 60px; height: 60px;
            border: 4px solid rgba(255,255,255,0.3);
            border-top: 4px solid white;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.5rem;
            font-weight: bold;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .timer-text { animation: none; transform: rotate(0); } /* è®©æ•°å­—ä¸è½¬ */

    </style>
</head>
<body>

<header>
    <div class="score-badge">ğŸŒŸ å¾—åˆ†: <span id="score">0</span></div>
    <div class="count-badge">ğŸ“¦ å‰©ä½™: <span id="remaining-count">0</span></div>
</header>

<div id="game-area">
    <div id="confetti-container"></div>
    <div id="feedback"></div>
    
    <div id="trash-item">
        <div class="emoji">ğŸ</div>
        <div class="name">è‹¹æœæ ¸</div>
    </div>
</div>

<div id="bins-container">
    <div class="bin bin-wet" data-type="wet">
        <span>ğŸ¥¬</span>
        <div>æ¹¿åƒåœ¾<br>(å¨ä½™)</div>
    </div>
    <div class="bin bin-dry" data-type="dry">
        <span>ğŸ§»</span>
        <div>å¹²åƒåœ¾<br>(å…¶ä»–)</div>
    </div>
    <div class="bin bin-recycle" data-type="recycle">
        <span>ğŸ¥¤</span>
        <div>å¯å›æ”¶ç‰©</div>
    </div>
    <div class="bin bin-harmful" data-type="harmful">
        <span>ğŸ”‹</span>
        <div>æœ‰å®³åƒåœ¾</div>
    </div>
</div>

<div id="error-modal">
    <div style="font-size: 80px;">ğŸ™…â€â™‚ï¸</div>
    <h2>å“å‘€ï¼Œé€‰é”™äº†ï¼</h2>
    <div class="error-card">
        <div style="font-size: 40px;" id="err-emoji">ğŸ</div>
        <div><strong id="err-name">è‹¹æœæ ¸</strong> åº”è¯¥æ‰”è¿›</div>
        <div class="correct-tag" id="err-bin">æ¹¿åƒåœ¾</div>
    </div>
    <div>è¯·è®°ä½æ­£ç¡®ç­”æ¡ˆ</div>
    <br>
    <div class="timer-ring">
        <div class="timer-text" id="countdown">5</div>
    </div>
</div>

<script>
    // --- 1. æ•°æ®ä¸é…ç½® ---
    const masterTrashData = [
        { name: "è‹¹æœæ ¸", icon: "ğŸ", type: "wet" },
        { name: "å‰©é¥­å‰©èœ", icon: "ğŸ›", type: "wet" },
        { name: "è¥¿ç“œçš®", icon: "ğŸ‰", type: "wet" },
        { name: "é±¼éª¨å¤´", icon: "ğŸŸ", type: "wet" },
        { name: "æ±¡æŸçº¸å·¾", icon: "ğŸ§»", type: "dry" },
        { name: "çƒŸè’‚", icon: "ğŸš¬", type: "dry" },
        { name: "ä¸€æ¬¡æ€§æ¯", icon: "ğŸ¥¤", type: "dry" },
        { name: "é“…ç¬”", icon: "âœï¸", type: "dry" },
        { name: "çŸ¿æ³‰æ°´ç“¶", icon: "ğŸ§´", type: "recycle" },
        { name: "é“ç½", icon: "ğŸ¥«", type: "recycle" },
        { name: "çº¸ç®±", icon: "ğŸ“¦", type: "recycle" },
        { name: "æ—§ä¹¦æœ¬", icon: "ğŸ“š", type: "recycle" },
        { name: "åºŸç”µæ± ", icon: "ğŸ”‹", type: "harmful" },
        { name: "è¿‡æœŸè¯å“", icon: "ğŸ’Š", type: "harmful" },
        { name: "å£çº¢", icon: "ğŸ’„", type: "harmful" },
        { name: "ç¯æ³¡", icon: "ğŸ’¡", type: "harmful" }
    ];

    const binNames = {
        'wet': 'æ¹¿åƒåœ¾ (å¨ä½™)',
        'dry': 'å¹²åƒåœ¾ (å…¶ä»–)',
        'recycle': 'å¯å›æ”¶ç‰©',
        'harmful': 'æœ‰å®³åƒåœ¾'
    };

    let gamePool = [];
    let currentTrash = null;
    let score = 0;
    let isLocked = false; // é”™è¯¯æ—¶é”å®šæ¸¸æˆ

    // DOM å¼•ç”¨
    const trashEl = document.getElementById('trash-item');
    const scoreEl = document.getElementById('score');
    const remainEl = document.getElementById('remaining-count');
    const bins = document.querySelectorAll('.bin');
    const errorModal = document.getElementById('error-modal');
    const countdownEl = document.getElementById('countdown');
    const feedbackEl = document.getElementById('feedback');
    const confettiContainer = document.getElementById('confetti-container');

    // --- 2. æ¸¸æˆæ ¸å¿ƒé€»è¾‘ ---
    function initGame() {
        gamePool = JSON.parse(JSON.stringify(masterTrashData));
        // æ´—ç‰Œç®—æ³•
        for (let i = gamePool.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [gamePool[i], gamePool[j]] = [gamePool[j], gamePool[i]];
        }
        score = 0;
        scoreEl.textContent = 0;
        spawnTrash();
    }

    function spawnTrash() {
        if (gamePool.length === 0) {
            alert("ğŸ‰ å¤ªæ£’äº†ï¼ä½ å®Œæˆäº†æ‰€æœ‰åˆ†ç±»ï¼å³å°†é‡æ–°å¼€å§‹...");
            initGame();
            return;
        }
        currentTrash = gamePool.pop();
        
        // æ›´æ–°UI
        trashEl.querySelector('.emoji').textContent = currentTrash.icon;
        trashEl.querySelector('.name').textContent = currentTrash.name;
        remainEl.textContent = gamePool.length;
        
        resetPosition();
    }

    function resetPosition() {
        trashEl.style.transition = 'transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275)';
        trashEl.style.transform = 'translate(0,0)';
        trashEl.style.left = '50%';
        trashEl.style.top = '35%'; // ç¨å¾®é ä¸Š
        trashEl.style.marginLeft = '-65px';
        trashEl.style.marginTop = '-65px';
        trashEl.style.display = 'flex';
        trashEl.style.opacity = '1';
        
        setTimeout(() => { trashEl.style.transition = 'none'; }, 400);
    }

    // --- 3. äº¤äº’é€»è¾‘ (æ‹–æ‹½) ---
    let isDragging = false;
    let startX, startY;

    trashEl.addEventListener('touchstart', onDragStart, {passive:false});
    trashEl.addEventListener('touchmove', onDragMove, {passive:false});
    trashEl.addEventListener('touchend', onDragEnd);
    // é¼ æ ‡å…¼å®¹
    trashEl.addEventListener('mousedown', onDragStart);
    document.addEventListener('mousemove', onDragMove);
    document.addEventListener('mouseup', onDragEnd);

    function onDragStart(e) {
        if(isLocked) return;
        e.preventDefault();
        isDragging = true;
        trashEl.classList.add('dragging');

        const point = e.touches ? e.touches[0] : e;
        const rect = trashEl.getBoundingClientRect();
        startX = point.clientX - rect.left;
        startY = point.clientY - rect.top;
    }

    function onDragMove(e) {
        if(!isDragging || isLocked) return;
        e.preventDefault();
        const point = e.touches ? e.touches[0] : e;
        
        trashEl.style.position = 'fixed';
        trashEl.style.left = (point.clientX - startX) + 'px';
        trashEl.style.top = (point.clientY - startY) + 'px';
        trashEl.style.margin = 0;
        
        checkHover(point.clientX, point.clientY);
    }

    function onDragEnd(e) {
        if(!isDragging) return;
        isDragging = false;
        trashEl.classList.remove('dragging');

        const rect = trashEl.getBoundingClientRect();
        const center = { x: rect.left + rect.width/2, y: rect.top + rect.height/2 };
        
        const target = getTargetBin(center.x, center.y);
        
        if (target) {
            handleAnswer(target.dataset.type);
        } else {
            resetPosition();
        }
        bins.forEach(b => b.classList.remove('hovered'));
    }

    function checkHover(x, y) {
        bins.forEach(bin => {
            const r = bin.getBoundingClientRect();
            if (x > r.left && x < r.right && y > r.top) {
                bin.classList.add('hovered');
            } else {
                bin.classList.remove('hovered');
            }
        });
    }

    function getTargetBin(x, y) {
        let t = null;
        bins.forEach(bin => {
            const r = bin.getBoundingClientRect();
            // åªè¦åœ¨æ¨ªå‘èŒƒå›´å†…ï¼Œä¸”é«˜åº¦è¶…è¿‡åƒåœ¾æ¡¶é¡¶éƒ¨å³å¯
            if (x > r.left && x < r.right && y > r.top) t = bin;
        });
        return t;
    }

    // --- 4. åˆ¤å®šä¸ç‰¹æ•ˆ ---
    function handleAnswer(type) {
        if (type === currentTrash.type) {
            // æ­£ç¡®
            score += 10;
            scoreEl.textContent = score;
            
            // è§†è§‰åé¦ˆ
            showSuccessEffect();
            fireConfetti();
            
            trashEl.style.opacity = '0';
            trashEl.style.transform = 'scale(0.5)';
            
            setTimeout(spawnTrash, 600);
        } else {
            // é”™è¯¯
            showErrorModal();
        }
    }

    function showSuccessEffect() {
        feedbackEl.textContent = "âœ¨ å®Œç¾! âœ¨";
        feedbackEl.style.opacity = 1;
        feedbackEl.style.transform = 'scale(1.2)';
        feedbackEl.style.top = '15%';
        
        setTimeout(() => {
            feedbackEl.style.opacity = 0;
            feedbackEl.style.transform = 'scale(1)';
            feedbackEl.style.top = '20%';
        }, 1000);
    }

    // çº¯JSç”Ÿæˆç®€å•çš„å½©å¸¦ç‰¹æ•ˆ
    function fireConfetti() {
        const colors = ['#e74c3c', '#3498db', '#f1c40f', '#2ecc71', '#9b59b6'];
        for(let i=0; i<30; i++) {
            const conf = document.createElement('div');
            conf.classList.add('confetti');
            conf.style.background = colors[Math.floor(Math.random()*colors.length)];
            conf.style.left = (Math.random() * 100) + '%';
            conf.style.top = '-10px';
            // éšæœºå¤§å°å’Œé€Ÿåº¦
            const dur = Math.random() * 1 + 0.5;
            conf.style.animationDuration = dur + 's';
            
            confettiContainer.appendChild(conf);
            
            setTimeout(() => conf.remove(), dur * 1000);
        }
    }

    // --- 5. é”™è¯¯å¤„ç† (é”å®š5ç§’) ---
    function showErrorModal() {
        isLocked = true;
        
        // å¡«å……é”™è¯¯ä¿¡æ¯
        document.getElementById('err-emoji').textContent = currentTrash.icon;
        document.getElementById('err-name').textContent = currentTrash.name;
        document.getElementById('err-bin').textContent = binNames[currentTrash.type];
        
        errorModal.style.display = 'flex';
        
        let timeLeft = 5;
        countdownEl.textContent = timeLeft;
        
        const timer = setInterval(() => {
            timeLeft--;
            countdownEl.textContent = timeLeft;
            if (timeLeft <= 0) {
                clearInterval(timer);
                errorModal.style.display = 'none';
                isLocked = false;
                resetPosition(); // é‡æ–°ç»™æœºä¼šæ‰”
            }
        }, 1000);
    }

    // å¯åŠ¨
    initGame();

</script>
</body>

</html>


